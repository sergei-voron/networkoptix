- job:
    name: networkoptix-test-job
    description: |
        please do not edit this job in web browser
    concurrent: true
    disabled: false
    properties:
        - disable-resume
        - build-discarder:
            num-to-keep: 10
    project-type: matrix
    parameters:
        - git-parameter:
              branch: ''
              name: BRANCH
              description: Choose branch to checkout
              type: PT_BRANCH_TAG
              tagFilter: '*'
              branchFilter: 'origin/(.*)'
              sortMode: ASCENDING
              defaultValue: 'master'
              selectedValue: DEFAULT
              quickFilterEnabled: false
        - matrix-combinations:
            name: Platform
            description: "Select matrix combinations"
            filter: ""

    axes:
      - axis:
          type: slave
          name: 'OS'
          values:
              - 'linux-agent'
              - 'windows-agent'

    scm:
        - git:
            url: https://github.com/sergei-voron/networkoptix.git
            wipe-workspace: true
            branches:
                - ${BRANCH}
    builders:
        - shell: python3 main.py
        - copyartifact:
              project: "networkoptix-test-job/OS=linux-agent"
              filter: '**/*'
      #          target: /home/foo
              which-build: downstream-build
              upstream-project-name: "networkoptix-test-job"
              upstream-build-number: "${BUILD_NUMBER}"
              build-number: "${BUILD_NUMBER}"
              optional: false
              flatten: false
      #          do-not-fingerprint: true
              parameter-filters: PUBLISH=true
    publishers:
      - archive:
          artifacts: '**/*'
          allow-empty: 'true'
          fingerprint: true
          default-excludes: false
      - chuck-norris


